## Overview

This script builds a personalized movie recommendation system using the SVD (Singular Value Decomposition) algorithm from the `surprise` library. The system uses collaborative filtering based on historical movie ratings and a user's recent ratings to suggest movies the user is likely to enjoy.

The script supports two main modes:
1. **Model Training and Prediction** — Builds an SVD model by combining a large ratings dataset with 5 user-provided movie ratings, and outputs top-N recommendations.
2. **Prediction with Pre-Trained Model** — Reloads a previously trained model to generate recommendations for new user input without retraining.

---

## Datasets

1. `ratings_export.csv`:  
   - Contains approximately 1 million user-movie-rating entries.  
   - Columns used: `user_id`, `movie_id`, `rating_val`.

2. `user_ratings.csv`:  
   - Contains 5 ratings from a single target user.  
   - Same format as the ratings export: `user_id`, `movie_id`, `rating_val`.

3. `movie_data.csv`:  
   - Metadata for all available movies.
   - Used to ensure that recommended movie IDs map to real movie titles and metadata.

---

## Steps

### 1. Load Data
- Reads the full historical ratings (`ratings_export.csv`) and the 5 movie ratings provided by the target user (`user_ratings.csv`).
- Concatenates both datasets, ensuring no duplicate entries.

### 2. Build SVD Recommendation Model
- Loads the data into the `surprise` framework using a rating scale of 1 to 10.
- Trains an SVD model on the combined dataset.

### 3. Generate Recommendations
- Identifies all movies that the target user has **not yet rated**.
- Uses the trained SVD model to predict ratings for these unseen movies.
- Sorts predictions in descending order of estimated rating.
- Outputs the top 5 recommendations.

### 4. Save Recommendations
- Saves the top 5 predicted movie recommendations (movie ID and predicted rating) to a CSV file: `recommendations_for_user.csv`.

---

## Model Saving and Reloading

- After training, the SVD model is saved as `svd_model.pkl` using `surprise.dump`.
- Later predictions can be generated by reloading this model and combining it with new user ratings (`user_ratings.csv`).
- This avoids retraining for each user input.

---

## Dependencies

- `pandas`
- `numpy`
- `surprise` (for collaborative filtering)
- The script also installs required packages using `pip install`, including a specific version of `numpy` to ensure compatibility.

---

## Output

- Console output: Top 5 recommended movie IDs with predicted ratings.
- File output: `recommendations_for_user.csv` with the same recommendations.